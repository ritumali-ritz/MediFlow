<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Health Queue - Admin Portal</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@600;700&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
        }

        /* Government-style Navigation */
        .top-bar {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 8px 50px;
            font-size: 13px;
        }

        .top-bar-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .gov-links a {
            color: #495057;
            text-decoration: none;
            margin-left: 20px;
            transition: color 0.3s;
        }

        .gov-links a:hover {
            color: #1e3c72;
        }

        /* Main Navigation */
        nav {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 15px 50px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .nav-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-logo {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        .nav-title h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .nav-subtitle {
            font-size: 12px;
            opacity: 0.9;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }

        .nav-menu a:hover {
            opacity: 0.8;
        }

        /* Professional Header */
        header {
            background: white;
            padding: 30px 50px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
        }

        .breadcrumb {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 15px;
        }

        .breadcrumb a {
            color: #1e3c72;
            text-decoration: none;
        }

        .page-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .page-description {
            color: #6c757d;
            font-size: 16px;
        }

        /* Container */
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px 50px;
        }

        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #1e3c72;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .stat-number {
            font-size: 42px;
            font-weight: 700;
            color: #1e3c72;
            line-height: 1;
        }

        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            font-weight: 500;
            margin-top: 8px;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .panel-header {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .panel-header-icon {
            font-size: 24px;
        }

        .panel-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: 600;
        }

        .panel-body {
            padding: 30px;
        }

        /* Forms */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #34495e;
            font-size: 14px;
        }

        input,
        select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
            transition: border-color 0.3s;
            background: white;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: #1e3c72;
        }

        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-family: 'Montserrat', sans-serif;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(30, 60, 114, 0.3);
        }

        /* Filter Section */
        .filter-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #e0e6ed;
        }

        .filter-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* Lists */
        .list-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .list-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #e0e6ed;
            transition: all 0.2s;
        }

        .list-item:hover {
            border-color: #1e3c72;
            box-shadow: 0 4px 12px rgba(30, 60, 114, 0.1);
        }

        .item-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .item-detail {
            font-size: 13px;
            color: #7f8c8d;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 6px;
            margin-top: 10px;
        }

        .badge-district {
            background: #e3f2fd;
            color: #1565c0;
        }

        .badge-tehsil {
            background: #f3e5f5;
            color: #6a1b9a;
        }

        /* Password Display */
        .password-display {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .password-value {
            font-size: 24px;
            font-weight: 700;
            color: #1e3c72;
            margin: 10px 0;
            letter-spacing: 2px;
            font-family: 'Courier New', monospace;
        }

        /* Messages */
        .message {
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            display: none;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        /* Section Titles */
        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 22px;
            font-weight: 700;
            color: #2c3e50;
            margin: 40px 0 25px;
            padding-bottom: 12px;
            border-bottom: 3px solid #1e3c72;
        }

        /* Footer */
        footer {
            background: #2c3e50;
            color: white;
            padding: 50px 0 20px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 50px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            margin-bottom: 20px;
            color: #00f5ff;
        }

        .footer-section p {
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #00f5ff;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 13px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .footer-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {

            .container,
            .header-content,
            .nav-content,
            .footer-content {
                padding-left: 20px;
                padding-right: 20px;
            }

            .top-bar {
                padding: 8px 20px;
            }

            nav {
                padding: 15px 20px;
            }

            .form-row,
            .filter-grid {
                grid-template-columns: 1fr;
            }

            .list-container {
                grid-template-columns: 1fr;
            }

            .footer-grid {
                grid-template-columns: 1fr;
            }

            .nav-menu {
                display: none;
            }
        }
    </style>
</head>

<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-content">
            <div>Government of India | Ministry of Health & Family Welfare</div>
            <div class="gov-links">
                <a href="#">Skip to main content</a>
                <a href="#">Screen Reader Access</a>
                <a href="#">A-</a>
                <a href="#">A</a>
                <a href="#">A+</a>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav>
        <div class="nav-content">
            <div class="nav-brand">
                <div class="nav-logo">üè•</div>
                <div class="nav-title">
                    <h1>Smart Health Queue</h1>
                    <div class="nav-subtitle">National Health Management System</div>
                </div>
            </div>
            <ul class="nav-menu">
                <li><a href="#dashboard">Dashboard</a></li>
                <li><a href="#hospitals">Hospitals</a></li>
                <li><a href="#doctors">Doctors</a></li>
                <li><a href="#reports">Reports</a></li>
            </ul>
        </div>
    </nav>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="breadcrumb">
                <a href="#">Home</a> / <a href="#">Admin</a> / Dashboard
            </div>
            <h2 class="page-title">Super Admin Portal</h2>
            <p class="page-description">Manage hospitals, doctors, and health services across Maharashtra</p>
        </div>
    </header>

    <div class="container">
        <!-- Statistics -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">üè•</div>
                    <div class="stat-label">Total Hospitals</div>
                </div>
                <div class="stat-number" id="totalHospitals">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">üë®‚Äç‚öïÔ∏è</div>
                    <div class="stat-label">Total Doctors</div>
                </div>
                <div class="stat-number" id="totalDoctors">0</div>
            </div>
        </div>

        <!-- Messages -->
        <div id="successMessage" class="message success"></div>
        <div id="errorMessage" class="message error"></div>

        <!-- Management Panels -->
        <div class="main-grid">
            <!-- Hospital Management -->
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-header-icon">üè•</span>
                    <span class="panel-title">Hospital Management</span>
                </div>
                <div class="panel-body">
                    <form id="hospitalForm">
                        <div class="form-group">
                            <label>Hospital Name</label>
                            <input type="text" id="hospitalName" required placeholder="Enter hospital name">
                        </div>
                        <div class="form-group">
                            <label>Full Address</label>
                            <input type="text" id="hospitalAddress" required placeholder="Complete address">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>District</label>
                                <select id="hospitalDistrict" required>
                                    <option value="">Select District</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Tehsil</label>
                                <select id="hospitalTehsil" required>
                                    <option value="">Select Tehsil</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit">Add Hospital</button>
                    </form>
                </div>
            </div>

            <!-- Doctor Management -->
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-header-icon">üë®‚Äç‚öïÔ∏è</span>
                    <span class="panel-title">Doctor Management</span>
                </div>
                <div class="panel-body">
                    <form id="doctorForm">
                        <div class="form-group">
                            <label>Doctor Name</label>
                            <input type="text" id="doctorName" required placeholder="Dr. Full Name">
                        </div>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="doctorEmail" required placeholder="doctor@hospital.com">
                        </div>
                        <div class="form-group">
                            <label>Assign Hospital</label>
                            <select id="doctorHospital" required>
                                <option value="">Select Hospital</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Department</label>
                            <select id="doctorDepartment" required>
                                <option value="general">General Medicine</option>
                                <option value="cardiology">Cardiology</option>
                                <option value="pediatrics">Pediatrics</option>
                                <option value="orthopedics">Orthopedics</option>
                                <option value="dermatology">Dermatology</option>
                                <option value="gynecology">Gynecology</option>
                                <option value="neurology">Neurology</option>
                            </select>
                        </div>
                        <button type="submit">Create Doctor Account</button>
                    </form>
                    <div id="doctorCredentials" class="password-display" style="display: none;">
                        <strong>‚úÖ Doctor Account Created Successfully</strong><br><br>
                        <strong>Email:</strong> <span id="createdEmail"></span><br>
                        <strong>Password (Numeric):</strong><br>
                        <div class="password-value" id="createdPassword"></div>
                        <small style="color: #856404;">‚ö†Ô∏è Please share these credentials securely with the
                            doctor</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Directory Section -->
        <div class="panel">
            <div class="panel-header">
                <span class="panel-header-icon">üìã</span>
                <span class="panel-title">Hospitals & Doctors Directory</span>
            </div>
            <div class="panel-body">
                <!-- Filters -->
                <div class="filter-section">
                    <div class="filter-title">üîç Filter by Location</div>
                    <div class="filter-grid">
                        <div class="form-group">
                            <label>District</label>
                            <select id="filterDistrict">
                                <option value="">All Districts</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tehsil</label>
                            <select id="filterTehsil">
                                <option value="">All Tehsils</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Hospitals List -->
                <h3 class="section-title">Registered Hospitals</h3>
                <div class="list-container" id="hospitalsList"></div>

                <!-- Doctors List -->
                <h3 class="section-title">Registered Doctors</h3>
                <div class="list-container" id="doctorsList"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>About Smart Health Queue</h3>
                    <p>A digital initiative by the Government of India to streamline healthcare services and reduce
                        waiting times at public health facilities across the nation.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#">Home</a></li>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Help & Support</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#">User Manual</a></li>
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact</h3>
                    <ul class="footer-links">
                        <li>üìß support@healthqueue.gov.in</li>
                        <li>üìû 1800-XXX-XXXX (Toll Free)</li>
                        <li>üè¢ Ministry of Health & Family Welfare</li>
                        <li>üìç New Delhi, India</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 Smart Health Queue System | Government of India | Developed by Ritex Studious</p>
                <p style="margin-top: 10px;">Last Updated: December 2025 | Version 1.0</p>
            </div>
        </div>
    </footer>

    <script type="module">
        import { initializeApp, getApp, getApps } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, query, where } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, createUserWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBleAsfOdYo6NA1Mx2PibF4bAWijUSJTBY",
            authDomain: "smart-health-queue.firebaseapp.com",
            projectId: "smart-health-queue",
            storageBucket: "smart-health-queue.firebasestorage.app",
            messagingSenderId: "707832193088",
            appId: "1:707832193088:web:00f4f84add5195a3027fa5"
        };

        // Main App (for Admin Auth)
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Secondary App (for Doctor Creation without logging out Admin)
        let secondaryApp;
        if (getApps().length > 1) {
            secondaryApp = getApps()[1];
        } else {
            secondaryApp = initializeApp(firebaseConfig, "Secondary");
        }
        const secondaryAuth = getAuth(secondaryApp);

        // Full Maharashtra Data
        const maharashtraData = {
            "Ahmednagar": ["Ahmednagar", "Akole", "Jamkhed", "Karjat", "Kopargaon", "Nagar", "Nevasa", "Parner", "Pathardi", "Rahata", "Rahuri", "Sangamner", "Shevgaon", "Shrigonda", "Shrirampur"],
            "Akola": ["Akola", "Akot", "Balapur", "Barshitakli", "Murtizapur", "Patur", "Telhara"],
            "Amravati": ["Achalpur", "Amravati", "Anjangaon Surji", "Bhatkuli", "Chandur Railway", "Chandurbazar", "Chikhaldara", "Daryapur", "Dharni", "Dhamangaon Railway", "Morshi", "Nandgaon Khandeshwar", "Teosa", "Warud"],
            "Aurangabad": ["Aurangabad", "Gangapur", "Kannad", "Khuldabad", "Paithan", "Phulambri", "Sillod", "Soegaon", "Vaijapur"],
            "Beed": ["Ambajogai", "Ashti", "Beed", "Dharur", "Georai", "Kaij", "Majalgaon", "Parli", "Patoda", "Shirur-Kasar", "Wadwani"],
            "Bhandara": ["Bhandara", "Lakhani", "Mohadi", "Pauni", "Sakoli", "Tumsar"],
            "Buldhana": ["Buldana", "Chikhli", "Deulgaon Raja", "Jalgaon Jamod", "Khamgaon", "Lonar", "Malkapur", "Mehkar", "Motala", "Nandura", "Sangrampur", "Shegaon", "Sindkhed Raja"],
            "Chandrapur": ["Ballarpur", "Bhadravati", "Bramhapuri", "Chandrapur", "Chimur", "Gondpipri", "Jivati", "Korpana", "Mul", "Nagbhir", "Pombhurna", "Rajura", "Saoli", "Sindewahi", "Warora"],
            "Dhule": ["Dhule", "Sakri", "Shirpur", "Sindkhede"],
            "Gadchiroli": ["Aheri", "Armori", "Bhamragad", "Chamorshi", "Desaiganj", "Dhanora", "Etapalli", "Gadchiroli", "Korchi", "Kurkheda", "Mulchera", "Sironcha"],
            "Gondia": ["Amgaon", "Arjuni Morgaon", "Deori", "Goregaon", "Gondia", "Sadak Arjuni", "Salekasa", "Tirora"],
            "Hingoli": ["Aundha Nagnath", "Basmath", "Hingoli", "Kalamnuri", "Sengaon"],
            "Jalgaon": ["Amalner", "Bhadgaon", "Bhusawal", "Bodwad", "Chalisgaon", "Chopda", "Dharangaon", "Erandol", "Jalgaon", "Jamner", "Muktainagar", "Pachora", "Parola", "Raver", "Yawal"],
            "Jalna": ["Ambad", "Badnapur", "Bhokardan", "Ghansawangi", "Jafferabad", "Jalna", "Mantha", "Partur"],
            "Kolhapur": ["Ajra", "Bavda", "Bhudargad", "Chandgad", "Gadhinglaj", "Hatkanangle", "Kagal", "Karvir", "Panhala", "Radhanagari", "Shahuwadi", "Shirol"],
            "Latur": ["Ahmadpur", "Ausa", "Chakur", "Deoni", "Jalkot", "Latur", "Nilanga", "Renapur", "Shirur-Anantpal", "Udgir"],
            "Mumbai City": ["Mumbai City"],
            "Mumbai Suburban": ["Andheri", "Borivali", "Kurla"],
            "Nagpur": ["Bhiwapur", "Hingna", "Kalameshwar", "Kamptee", "Katol", "Kuhi", "Mauda", "Nagpur Rural", "Nagpur Urban", "Narkhed", "Parseoni", "Ramtek", "Savner", "Umred"],
            "Nanded": ["Ardhapur", "Bhokar", "Biloli", "Deglur", "Dharmabad", "Hadgaon", "Himayatnagar", "Kandhar", "Kinwat", "Loha", "Mahur", "Mudkhed", "Mukhed", "Naigaon", "Nanded", "Umri"],
            "Nandurbar": ["Akkalkuwa", "Akrani", "Nandurbar", "Nawapur", "Shahade", "Talode"],
            "Nashik": ["Baglan", "Chandvad", "Deola", "Dindori", "Igatpuri", "Kalwan", "Malegaon", "Nandgaon", "Nashik", "Niphad", "Peint", "Sinnar", "Surgana", "Trimbakeshwar", "Yeola"],
            "Osmanabad": ["Bhum", "Kalamb", "Lohara", "Osmanabad", "Paranda", "Tuljapur", "Umarga", "Washi"],
            "Palghar": ["Dahanu", "Jawhar", "Mokhada", "Palghar", "Talasari", "Vasai", "Vikramgad", "Wada"],
            "Parbhani": ["Gangakhed", "Jintur", "Manwath", "Palam", "Parbhani", "Pathri", "Purna", "Sailu", "Sonpeth"],
            "Pune": ["Ambegaon", "Baramati", "Bhor", "Daund", "Haveli", "Indapur", "Junnar", "Khed", "Mawal", "Mulshi", "Pune City", "Purandhar", "Shirur", "Velhe"],
            "Raigad": ["Alibag", "Karjat", "Khalapur", "Mahad", "Mangaon", "Mhasla", "Murud", "Panvel", "Pen", "Poladpur", "Roha", "Shrivardhan", "Sudhagad", "Tala", "Uran"],
            "Ratnagiri": ["Chiplun", "Dapoli", "Guhagar", "Khed", "Lanja", "Mandangad", "Rajapur", "Ratnagiri", "Sangameshwar"],
            "Sangli": ["Atpadi", "Jat", "Kadegaon", "Kavathemahankal", "Khanapur-Vita", "Miraj", "Palus", "Shirala", "Tasgaon", "Walwa"],
            "Satara": ["Jaoli", "Karad", "Khandala", "Khatav", "Koregaon", "Mahabaleshwar", "Man", "Patan", "Phaltan", "Satara", "Wai"],
            "Sindhudurg": ["Devgad", "Dodamarg", "Kankavli", "Kudal", "Malwan", "Sawantwadi", "Vaibhavvadi", "Vengurla"],
            "Solapur": ["Akkalkot", "Barshi", "Karmala", "Madha", "Malshiras", "Mangalvedhe", "Mohol", "Pandharpur", "Sangole", "Solapur North", "Solapur South"],
            "Thane": ["Ambarnath", "Bhiwandi", "Kalyan", "Murbad", "Shahapur", "Thane", "Ulhasnagar"],
            "Wardha": ["Arvi", "Ashti", "Deoli", "Hinganghat", "Karanja", "Samudrapur", "Seloo", "Wardha"],
            "Washim": ["Karanja", "Malegaon", "Mangrulpir", "Manora", "Risod", "Washim"],
            "Yavatmal": ["Arni", "Babulgaon", "Darwha", "Digras", "Ghatanji", "Kalamb", "Kelapur", "Mahagaon", "Maregaon", "Ner", "Pusad", "Ralegaon", "Umarkhed", "Wani", "Yavatmal", "Zari-Jamani"]
        };

        function populateDistricts() {
            const districts = Object.keys(maharashtraData).sort();
            ['hospitalDistrict', 'filterDistrict'].forEach(id => {
                const select = document.getElementById(id);
                select.innerHTML = id === 'filterDistrict' ? '<option value="">All Districts</option>' : '<option value="">Select District</option>';
                districts.forEach(district => {
                    select.innerHTML += `<option value="${district}">${district}</option>`;
                });
            });
        }

        document.getElementById('hospitalDistrict').addEventListener('change', function () {
            const select = document.getElementById('hospitalTehsil');
            select.innerHTML = '<option value="">Select Tehsil</option>';
            if (this.value && maharashtraData[this.value]) {
                maharashtraData[this.value].forEach(tehsil => {
                    select.innerHTML += `<option value="${tehsil}">${tehsil}</option>`;
                });
            }
        });

        document.getElementById('filterDistrict').addEventListener('change', function () {
            const select = document.getElementById('filterTehsil');
            select.innerHTML = '<option value="">All Tehsils</option>';
            if (this.value && maharashtraData[this.value]) {
                maharashtraData[this.value].forEach(tehsil => {
                    select.innerHTML += `<option value="${tehsil}">${tehsil}</option>`;
                });
            }
            loadData();
        });

        document.getElementById('filterTehsil').addEventListener('change', loadData);

        let allHospitals = [];
        let allDoctors = [];

        async function loadData() {
            // Check auth first
            auth.onAuthStateChanged(async (user) => {
                if (!user) {
                    // Redirect to login if needed, or show login modal
                    // console.log("No admin logged in");
                }
            });

            const hospitalsSnap = await getDocs(collection(db, 'clinics'));
            document.getElementById('totalHospitals').textContent = hospitalsSnap.size;

            allHospitals = [];
            const hospitalsList = document.getElementById('hospitalsList');
            const hospitalSelect = document.getElementById('doctorHospital');
            hospitalsList.innerHTML = '';
            hospitalSelect.innerHTML = '<option value="">Select Hospital</option>';

            hospitalsSnap.forEach(doc => {
                const data = doc.data();
                allHospitals.push({ id: doc.id, ...data });

                const district = data.location?.district || 'Unknown';
                const tehsil = data.location?.tehsil || 'Unknown';

                hospitalsList.innerHTML += `
                    <div class="list-item">
                        <div class="item-title">üè• ${data.name}</div>
                        <div class="item-detail">üìç ${data.address}</div>
                        <div>
                            <span class="badge badge-district">${district}</span>
                            <span class="badge badge-tehsil">${tehsil}</span>
                        </div>
                    </div>
                `;
                hospitalSelect.innerHTML += `<option value="${doc.id}">${data.name}</option>`;
            });

            const doctorsQuery = query(collection(db, 'users'), where('role', '==', 'doctor'));
            const doctorsSnap = await getDocs(doctorsQuery);
            document.getElementById('totalDoctors').textContent = doctorsSnap.size;

            allDoctors = [];
            doctorsSnap.forEach(doc => {
                allDoctors.push({ id: doc.id, ...doc.data() });
            });

            displayDoctors();
        }

        function displayDoctors() {
            const filterDistrict = document.getElementById('filterDistrict').value;
            const filterTehsil = document.getElementById('filterTehsil').value;
            const doctorsList = document.getElementById('doctorsList');

            let filtered = allDoctors.filter(doctor => {
                const hospital = allHospitals.find(h => h.id === doctor.hospitalId);
                if (!hospital) return false;

                const matchDistrict = !filterDistrict || hospital.location?.district === filterDistrict;
                const matchTehsil = !filterTehsil || hospital.location?.tehsil === filterTehsil;

                return matchDistrict && matchTehsil;
            });

            doctorsList.innerHTML = '';
            filtered.forEach(doctor => {
                const hospital = allHospitals.find(h => h.id === doctor.hospitalId);
                const hospitalName = hospital?.name || 'Unknown';
                const district = hospital?.location?.district || 'Unknown';
                const tehsil = hospital?.location?.tehsil || 'Unknown';
                const passwordDisplay = doctor.password ? `üîë ${doctor.password}` : 'üîë (Not Saved)';

                doctorsList.innerHTML += `
                    <div class="list-item">
                        <div class="item-title">üë®‚Äç‚öïÔ∏è ${doctor.displayName || 'Unknown'}</div>
                        <div class="item-detail">üìß ${doctor.email}</div>
                        <div class="item-detail">üè• ${hospitalName}</div>
                        <div class="item-detail" style="color: #d64161; font-weight: bold;">${passwordDisplay}</div>
                        <div>
                            <span class="badge badge-district">${district}</span>
                            <span class="badge badge-tehsil">${tehsil}</span>
                        </div>
                    </div>
                `;
            });
        }

        document.getElementById('hospitalForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                await addDoc(collection(db, 'clinics'), {
                    name: document.getElementById('hospitalName').value,
                    address: document.getElementById('hospitalAddress').value,
                    location: {
                        state: 'Maharashtra',
                        district: document.getElementById('hospitalDistrict').value,
                        tehsil: document.getElementById('hospitalTehsil').value
                    },
                    doctorIds: [],
                    ownerId: 'admin',
                    departmentIds: ['general', 'cardiology', 'pediatrics', 'orthopedics', 'dermatology', 'gynecology', 'neurology'],
                    departmentDoctors: {}
                });
                showSuccess('‚úÖ Hospital added successfully');
                document.getElementById('hospitalForm').reset();
                loadData();
            } catch (error) {
                showError('‚ùå Error: ' + error.message);
            }
        });

        document.getElementById('doctorForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const email = document.getElementById('doctorEmail').value;
                // Generate 8-digit numeric password
                const password = Math.floor(10000000 + Math.random() * 90000000).toString();

                // Use secondaryAuth to create user without logging out Admin
                const userCredential = await createUserWithEmailAndPassword(secondaryAuth, email, password);

                await addDoc(collection(db, 'users'), {
                    uid: userCredential.user.uid,
                    email: email,
                    displayName: document.getElementById('doctorName').value,
                    role: 'doctor',
                    hospitalId: document.getElementById('doctorHospital').value,
                    department: document.getElementById('doctorDepartment').value,
                    password: password, // Storing password securely only accessible by admin
                    createdAt: new Date()
                });

                document.getElementById('createdEmail').textContent = email;
                document.getElementById('createdPassword').textContent = password;
                document.getElementById('doctorCredentials').style.display = 'block';

                showSuccess('‚úÖ Doctor account created successfully');
                document.getElementById('doctorForm').reset();

                // Cleanup secondary auth if needed (signOut) - optional as it's a separate instance
                // secondaryAuth.signOut(); 

                loadData();
            } catch (error) {
                showError('‚ùå Error: ' + error.message);
            }
        });

        function showSuccess(msg) {
            const el = document.getElementById('successMessage');
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 5000);
        }

        function showError(msg) {
            const el = document.getElementById('errorMessage');
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 5000);
        }

        populateDistricts();
        loadData();
    </script>
</body>

</html>